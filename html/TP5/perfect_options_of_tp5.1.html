<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Thinkphp5.1的一些完美操作</title>
    <link rel="stylesheet" href="../../css/bootstrap.min.css">
    <script src="../../js/jQuery%20v3.3.1min.js"></script>
    <script src="../../js/bootstrap.min.js"></script>
    <link rel="stylesheet" href="../../css/main.css">
</head>
<body>

<div class="container">
    <nav class="navbar navbar-default">
        <div class="container-fluid">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header">
                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="#">liaoxx</a>
            </div>
            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                <ul class="nav navbar-nav">
                    <li class="active"><a href="../../index.html">首页 <span class="sr-only">(current)</span></a></li>
                    <li><a href="#">Link</a></li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">更多 <span class="caret"></span></a>
                        <ul class="dropdown-menu">
                            <li><a href="../vue_js.html">vue.js</a></li>
                            <li><a href="#">Another action</a></li>
                            <li><a href="#">Something else here</a></li>
                            <li role="separator" class="divider"></li>
                            <li><a href="#">Separated link</a></li>
                            <li role="separator" class="divider"></li>
                            <li><a href="#">One more separated link</a></li>
                        </ul>
                    </li>
                </ul>
                <form class="navbar-form navbar-left">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="来探索吧">
                    </div>
                    <button type="submit" class="btn btn-default">搜索</button>
                </form>
                <ul class="nav navbar-nav navbar-right">
                    <li><a href="#">关于</a></li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">乱写的 <span class="caret"></span></a>
                        <ul class="dropdown-menu">
                            <li><a href="#">Action</a></li>
                            <li><a href="#">Another action</a></li>
                            <li><a href="#">Something else here</a></li>
                            <li role="separator" class="divider"></li>
                            <li><a href="#">Separated link</a></li>
                        </ul>
                    </li>
                </ul>
            </div><!-- /.navbar-collapse -->
        </div><!-- /.container-fluid -->
    </nav>
    <div class="content">
        <ul>
            <li>
                <h3>
                    1.通过Ajax的post提交数据,将这些数据存储到数据库的 <b>单个表中</b>(如添加产品分类)
                </h3>
                <h5>
                    <pre>
(1).从视图获取数据,以键值对方式关联,然后用Ajax提交到后端接口,如下
                        <xmp>
   $('#submit').click(function ()
   {
        var goods_cate_name=$('#goods_cate_name').val();
        var goods_cate_summary=$('#goods_cate_summary').val();
        var pid=$('#pid').val();
        $.post
        (
             "{:Url('admin/productcategory/update')}",
             {
                  pid:pid,
                  goods_cate_name:goods_cate_name,
                  goods_cate_summary:goods_cate_summary
             },
             function (result)
             {
                  layer.msg(result, {
                  icon: 6
             });
        })
        return false;
   })
                        </xmp>
                    </pre>
                    <pre>
(2).将其存入数据库,以普通的思维方式如下
                        <xmp>
第一种以关联数组的方式将其承载,之后存入数据库中:
$post = input('post.');
      $data =
      [
            'goods_name' => $post['goods_name'],
            'goods_cate_id' => $post  ["goods_cate_id"],
            'goods_imgs' => $post['goods_imgs'],
            'goods_thumb' => $post['goods_thumb'],
            'goods_display_price' => $post['goods_display_price']
      ];
$goods_id= Db::table('shop_goods')->insertGetId($data);



第二种在insert() / insertGetId() 函数中直接传入一个关联数组,之后存入数据库中:

$goods_id= Db::table('shop_goods')
     ->insertGetId
          (
             [
                 'goods_name' => $post['goods_name'],
                 'goods_cate_id' => $post  ["goods_cate_id"],
                 'goods_imgs' => $post['goods_imgs'],
                 'goods_thumb' => $post['goods_thumb'],
                 'goods_display_price' => $post['goods_display_price']
             ]
          );
                        </xmp>
                    </pre>
                </h5>
                <pre>
(3).然而骚操作往往是这样子的:

$re = Db::name('goods_category')->insert(Request::post());
 因为   Request::post()    包含了所要提交的数据
当然局限性就是,提交数据的时候:

 $.post
  (
       "{:Url('admin/productcategory/update')}",
       {
            pid:pid,
            goods_cate_name:goods_cate_name,
            goods_cate_summary:goods_cate_summary
       },
       function (result)
       {
            layer.msg(result, {
            icon: 6
       });
  })

提交的数据索引要和数据库中的表的字段一一对应,不应出现不包含的字段,而且也只能提交到单个表中

                </pre>
                <hr>
            </li>
        </ul>
    </div>
</div>
</body>
</html>